name: DevOps Action Workflow

on:
  push:
    branches:
      - main
  workflow_dispatch:
    inputs:
      first-name:
        description: "First Name"
        required: true

jobs:
  job1:
    name: Print Hello and System Info
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Hello
        run: echo Hello

      - name: Ubuntu version
        run: lsb_release -a

      - name: Commit SHA
        run: echo Commit\ SHA:\ ${{ github.sha }}

  job2:
    name: Print files and run script
    runs-on: ubuntu-latest
    needs: job1
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Print files
        run: |
          cat 1.txt
          cat 2.txt
          cat 3.txt

      - name: Make script executable
        run: chmod +x ./test.sh

      - name: Run test.sh
        run: ./test.sh

  job3:
    name: Print Env Vars and Secret
    runs-on: ubuntu-latest
    needs: job2
    environment: devops
    steps:
      - name: Print First Name (env)
        env:
          FIRST_NAME: ${{ github.event.inputs.first-name }}
        run: echo First\ Name:\ $FIRST_NAME

      - name: Print Last Name (environment variable)
        run: echo Last\ Name:\ ${{ vars.LAST_NAME }}

      - name: Print Phone Number (secret)
        run: echo Phone\ Number:\ ${{ secrets.PHONE_NUMBER }}
